

<%= gmaps("map_options" => {
        :container_class => "mapContainer",
                       "auto_zoom" => false,
                       "auto_adjust" => true,
                       "zoom" => 13},
                        "markers" => { "data" => @json } ) %>
                        <!-- "options" => {"list_container" => "markers_list" } -->

<% content_for :scripts do %>
<script>
Gmaps.map.infobox = function(boxText) {
  return {
     content: boxText
    ,disableAutoPan: false
    ,maxWidth: 0
    ,pixelOffset: new google.maps.Size(-140, 0)
    ,zIndex: null
    ,boxStyle: {
      background: "url('http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.5/examples/tipbox.gif') no-repeat"
      ,opacity: 1
      ,width: "280px"
       }
    ,closeBoxMargin: "10px 2px 2px 2px"
    ,closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif"
    ,infoBoxClearance: new google.maps.Size(1, 1)
    ,isHidden: false
    ,pane: "floatPane"
    ,enableEventPropagation: false
 }};

Gmaps.map.callback = function() {
  // google.maps.event.addListener(Gmaps.map.map, 'idle', function(){
  //    //Map fully loaded here
  //    var bounds = Gmaps.map.map.getCenter();
  //       drawItems(bounds);
  //   });
  google.maps.event.addListener(Gmaps.map.map, 'dragend', function(){
     //Map fully loaded here
     var bounds = Gmaps.map.map.getCenter();
        drawItems(bounds);
        passItems(bounds);
    });



 //  google.maps.event.addListener(marker, 'mouseover', function() {
 //    infowindow.open(map, this);
 //  });
}

 </script>
 <% end %>
